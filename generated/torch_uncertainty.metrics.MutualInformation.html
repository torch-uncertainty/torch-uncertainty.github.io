


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>MutualInformation &mdash; TorchUncertainty 0.1.5 documentation</title>
  

  <link rel="shortcut icon" href="../_static/images/logo_torch_uncertainty.png" />
  
  

  

  
  
  

  

  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sg_gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sg_gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sg_gallery-rendered-html.css" type="text/css" />
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="next" title="NegativeLogLikelihood" href="torch_uncertainty.metrics.NegativeLogLikelihood.html" />
  <link rel="prev" title="Entropy" href="torch_uncertainty.metrics.Entropy.html" />
  <!-- Google Analytics -->
  <script type="text/javascript">
    var collapsedSections = [];
  </script>
  
  <!-- End Google Analytics -->
  

  
  <script src="../_static/js/modernizr.min.js"></script>
  <script>
    MathJax = {
        chtml: {
            scale: 1,
            minScale: 1,
        },
        svg: {
            scale: 1,
            minScale: 1,
        }
    }
</script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"
    integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://torch-uncertainty.github.io/"
        aria-label="OpenMMLab"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://github.com/ENSTA-U2IS/torch-uncertainty" target="_blank">GitHub</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>
  </div>
</div>

<body class="pytorch-body">

   

  

  <div class="table-of-contents-link-wrapper">
    <span>Table of Contents</span>
    <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
  </div>

  <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
    <div class="pytorch-side-scroll">
      <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <div class="pytorch-left-menu-search">
          

          
          
          
          

          



<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        
        
        
        
        
        <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction_uncertainty.html">Introduction to Classification Uncertainty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

        
        
      </div>
    </div>
  </nav>

  <div class="pytorch-container">
    <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
      <div class="pytorch-breadcrumbs-wrapper">
        















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
    <li>
      <a href="../index.html">
        Docs
      </a> &gt;
    </li>

    
    <li><a href="../api.html">API reference</a> &gt;</li>
    
    <li>MutualInformation</li>
    
    <!-- 
    <li class="pytorch-breadcrumbs-aside">
      
      
      
      
      
      <a href="/zh_CN//generated/torch_uncertainty.metrics.MutualInformation.html" class="fa fa-language"> 以中文阅读</a>
      
      
    </li>
    
     -->
  </ul>

  
</div>
      </div>

      <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
        Shortcuts
      </div>
    </div>

    <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
      <div class="pytorch-content-left">

        

        <div class="pytorch-call-to-action-links">
          <div id="tutorial-type">generated/torch_uncertainty.metrics.MutualInformation</div>

          <!-- <div id="google-colab-link">
            <img class="call-to-action-img" src="../_static/images/pytorch-colab.svg" />
            <div class="call-to-action-desktop-view">Run in Google Colab</div>
            <div class="call-to-action-mobile-view">Colab</div>
          </div> -->
          <div id="download-notebook-link">
            <img class="call-to-action-notebook-img" src="../_static/images/pytorch-download.svg" />
            <div class="call-to-action-desktop-view">Download Notebook</div>
            <div class="call-to-action-mobile-view">Notebook</div>
          </div>
          <div id="github-view-link">
            <img class="call-to-action-img" src="../_static/images/pytorch-github.svg" />
            <div class="call-to-action-desktop-view">View on GitHub</div>
            <div class="call-to-action-mobile-view">GitHub</div>
          </div>
        </div>

        
        
          <div class="rst-content">
            
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
              <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
                
                
  <section id="mutualinformation">
<h1>MutualInformation<a class="headerlink" href="#mutualinformation" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="torch_uncertainty.metrics.MutualInformation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torch_uncertainty.metrics.</span></span><span class="sig-name descname"><span class="pre">MutualInformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_uncertainty/metrics/mutual_information.html#MutualInformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch_uncertainty.metrics.MutualInformation" title="Permalink to this definition">¶</a></dt>
<dd><p>The Mutual Information Metric to estimate the epistemic uncertainty of
an ensemble of estimators.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reduction</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>Determines how to reduce over the
<span class="math notranslate nohighlight">\(B\)</span>/batch dimension:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'mean'</span></code> [default]: Averages score across samples</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'sum'</span></code>: Sum score across samples</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'none'</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>: Returns score per sample</p></li>
</ul>
</p></li>
<li><p><strong>kwargs</strong> – Additional keyword arguments, see <a class="reference external" href="https://torchmetrics.readthedocs.io/en/stable/pages/overview.html#metric-kwargs">Advanced metric settings</a>.</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Inputs:</dt><dd><ul>
<li><dl>
<dt><code class="xref py py-attr docutils literal notranslate"><span class="pre">probs</span></code>: the likelihoods provided by the ensemble as a Tensor</dt><dd><p>of shape <span class="math notranslate nohighlight">\((B, N, C)\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(B\)</span> is the batch size, <span class="math notranslate nohighlight">\(N\)</span> is the number of
estimators, and <span class="math notranslate nohighlight">\(C\)</span> is the number of classes.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If <code class="xref py py-attr docutils literal notranslate"><span class="pre">reduction</span></code> is not one of <code class="docutils literal notranslate"><span class="pre">'mean'</span></code>, <code class="docutils literal notranslate"><span class="pre">'sum'</span></code>,
    <code class="docutils literal notranslate"><span class="pre">'none'</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A higher mutual information can be interpreted as a higher epistemic
uncertainty. The Mutual Information is also computationally equivalent
to the Generalized Jensen-Shannon Divergence (GJSD).</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Make sure that the probabilities in <code class="xref py py-attr docutils literal notranslate"><span class="pre">probs</span></code> are normalized to sum
to one.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="torch_uncertainty.metrics.MutualInformation.add_state">
<span class="sig-name descname"><span class="pre">add_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_reduce_fx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">persistent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#torch_uncertainty.metrics.MutualInformation.add_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Add metric state variable. Only used by subclasses.</p>
<p>Metric state variables are either <cite>:class:`~torch.Tensor</cite> or an empty list, which can be appended to by the
metric. Each state variable must have a unique name associated with it. State variables are accessible as
attributes of the metric i.e, if <code class="docutils literal notranslate"><span class="pre">name</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;my_state&quot;</span></code> then its value can be accessed from an instance
<code class="docutils literal notranslate"><span class="pre">metric</span></code> as <code class="docutils literal notranslate"><span class="pre">metric.my_state</span></code>. Metric states behave like buffers and parameters of <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>
as they are also updated when <code class="docutils literal notranslate"><span class="pre">.to()</span></code> is called. Unlike parameters and buffers, metric states are not by
default saved in the modules <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The name of the state variable. The variable will then be accessible at <code class="docutils literal notranslate"><span class="pre">self.name</span></code>.</p></li>
<li><p><strong>default</strong> – Default value of the state; can either be a <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code> or an empty list.
The state will be reset to this value when <code class="docutils literal notranslate"><span class="pre">self.reset()</span></code> is called.</p></li>
<li><p><strong>dist_reduce_fx</strong> (<em>Optional</em>) – Function to reduce state across multiple processes in distributed mode.
If value is <code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;cat&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;min&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;max&quot;</span></code> we will use <code class="docutils literal notranslate"><span class="pre">torch.sum</span></code>,
<code class="docutils literal notranslate"><span class="pre">torch.mean</span></code>, <code class="docutils literal notranslate"><span class="pre">torch.cat</span></code>, <code class="docutils literal notranslate"><span class="pre">torch.min</span></code> and <code class="docutils literal notranslate"><span class="pre">torch.max`</span></code> respectively, each with argument
<code class="docutils literal notranslate"><span class="pre">dim=0</span></code>. Note that the <code class="docutils literal notranslate"><span class="pre">&quot;cat&quot;</span></code> reduction only makes sense if the state is a list, and not
a tensor. The user can also pass a custom function in this parameter.</p></li>
<li><p><strong>persistent</strong> (<em>Optional</em>) – whether the state will be saved as part of the modules <code class="docutils literal notranslate"><span class="pre">state_dict</span></code>.
Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Setting <code class="docutils literal notranslate"><span class="pre">dist_reduce_fx</span></code> to None will return the metric state synchronized across different processes.
However, there won’t be any reduction function applied to the synchronized metric state.</p>
<p>The metric states would be synced as follows</p>
<ul class="simple">
<li><p>If the metric state is <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, the synced value will be a stacked <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>
across the process dimension if the metric state was a <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>. The original
<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code> metric state retains dimension and hence the synchronized output will be of shape
<code class="docutils literal notranslate"><span class="pre">(num_process,</span> <span class="pre">...)</span></code>.</p></li>
<li><p>If the metric state is a <code class="docutils literal notranslate"><span class="pre">list</span></code>, the synced value will be a <code class="docutils literal notranslate"><span class="pre">list</span></code> containing the
combined elements from all processes.</p></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When passing a custom function to <code class="docutils literal notranslate"><span class="pre">dist_reduce_fx</span></code>, expect the synchronized metric state to follow
the format discussed in the above note.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">default</span></code> is not a <code class="docutils literal notranslate"><span class="pre">tensor</span></code> or an <code class="docutils literal notranslate"><span class="pre">empty</span> <span class="pre">list</span></code>.</p></li>
<li><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">dist_reduce_fx</span></code> is not callable or one of <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;sum&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;cat&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;min&quot;</span></code>,
    <code class="docutils literal notranslate"><span class="pre">&quot;max&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_uncertainty.metrics.MutualInformation.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#torch_uncertainty.metrics.MutualInformation.clone" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a copy of the metric.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_uncertainty.metrics.MutualInformation.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_uncertainty/metrics/mutual_information.html#MutualInformation.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch_uncertainty.metrics.MutualInformation.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes Mutual Information based on inputs passed in to <code class="docutils literal notranslate"><span class="pre">update</span></code>
previously.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="torch_uncertainty.metrics.MutualInformation.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#torch_uncertainty.metrics.MutualInformation.device" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the device of the metric.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_uncertainty.metrics.MutualInformation.double">
<span class="sig-name descname"><span class="pre">double</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#torch_uncertainty.metrics.MutualInformation.double" title="Permalink to this definition">¶</a></dt>
<dd><p>Override default and prevent dtype casting.</p>
<p>Please use <code class="xref py py-meth docutils literal notranslate"><span class="pre">Metric.set_dtype()</span></code> instead.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_uncertainty.metrics.MutualInformation.float">
<span class="sig-name descname"><span class="pre">float</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#torch_uncertainty.metrics.MutualInformation.float" title="Permalink to this definition">¶</a></dt>
<dd><p>Override default and prevent dtype casting.</p>
<p>Please use <code class="xref py py-meth docutils literal notranslate"><span class="pre">Metric.set_dtype()</span></code> instead.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_uncertainty.metrics.MutualInformation.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#torch_uncertainty.metrics.MutualInformation.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Aggregate and evaluate batch input directly.</p>
<p>Serves the dual purpose of both computing the metric on the current batch of inputs but also add the batch
statistics to the overall accumululating metric state. Input arguments are the exact same as corresponding
<code class="docutils literal notranslate"><span class="pre">update</span></code> method. The returned output is the exact same as the output of <code class="docutils literal notranslate"><span class="pre">compute</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – Any arguments as required by the metric <code class="docutils literal notranslate"><span class="pre">update</span></code> method.</p></li>
<li><p><strong>kwargs</strong> – Any keyword arguments as required by the metric <code class="docutils literal notranslate"><span class="pre">update</span></code> method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The output of the <code class="docutils literal notranslate"><span class="pre">compute</span></code> method evaluated on the current batch.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>TorchMetricsUserError</strong> – If the metric is already synced and <code class="docutils literal notranslate"><span class="pre">forward</span></code> is called again.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_uncertainty.metrics.MutualInformation.half">
<span class="sig-name descname"><span class="pre">half</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#torch_uncertainty.metrics.MutualInformation.half" title="Permalink to this definition">¶</a></dt>
<dd><p>Override default and prevent dtype casting.</p>
<p>Please use <code class="xref py py-meth docutils literal notranslate"><span class="pre">Metric.set_dtype()</span></code> instead.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="torch_uncertainty.metrics.MutualInformation.metric_state">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metric_state</span></span><a class="headerlink" href="#torch_uncertainty.metrics.MutualInformation.metric_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current state of the metric.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_uncertainty.metrics.MutualInformation.persistent">
<span class="sig-name descname"><span class="pre">persistent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#torch_uncertainty.metrics.MutualInformation.persistent" title="Permalink to this definition">¶</a></dt>
<dd><p>Change post-init if metric states should be saved to its state_dict.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_uncertainty.metrics.MutualInformation.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">__</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#torch_uncertainty.metrics.MutualInformation.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Override this method plot the metric value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_uncertainty.metrics.MutualInformation.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#torch_uncertainty.metrics.MutualInformation.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset metric state variables to their default value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_uncertainty.metrics.MutualInformation.set_dtype">
<span class="sig-name descname"><span class="pre">set_dtype</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dst_type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#torch_uncertainty.metrics.MutualInformation.set_dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Transfer all metric state to specific dtype. Special version of standard <cite>type</cite> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dst_type</strong> – the desired type as string or dtype object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_uncertainty.metrics.MutualInformation.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">destination</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_vars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#torch_uncertainty.metrics.MutualInformation.state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current state of metric as an dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>destination</strong> – Optional dictionary, that if provided, the state of module will be updated into the dict and
the same object is returned. Otherwise, an <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> will be created and returned.</p></li>
<li><p><strong>prefix</strong> – optional string, a prefix added to parameter and buffer names to compose the keys in state_dict.</p></li>
<li><p><strong>keep_vars</strong> – by default the <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code> returned in the state dict are detached from autograd.
If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, detaching will not be performed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_uncertainty.metrics.MutualInformation.sync">
<span class="sig-name descname"><span class="pre">sync</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist_sync_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">should_sync</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distributed_available</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#torch_uncertainty.metrics.MutualInformation.sync" title="Permalink to this definition">¶</a></dt>
<dd><p>Sync function for manually controlling when metrics states should be synced across processes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist_sync_fn</strong> – Function to be used to perform states synchronization</p></li>
<li><p><strong>process_group</strong> – Specify the process group on which synchronization is called.
default: <cite>None</cite> (which selects the entire world)</p></li>
<li><p><strong>should_sync</strong> – Whether to apply to state synchronization. This will have an impact
only when running in a distributed setting.</p></li>
<li><p><strong>distributed_available</strong> – Function to determine if we are running inside a distributed setting</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>TorchMetricsUserError</strong> – If the metric is already synced and <code class="docutils literal notranslate"><span class="pre">sync</span></code> is called again.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_uncertainty.metrics.MutualInformation.sync_context">
<span class="sig-name descname"><span class="pre">sync_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist_sync_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">should_sync</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">should_unsync</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distributed_available</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#torch_uncertainty.metrics.MutualInformation.sync_context" title="Permalink to this definition">¶</a></dt>
<dd><p>Context manager to synchronize states.</p>
<p>This context manager is used in distributed setting and makes sure that the local cache states are restored
after yielding the syncronized state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist_sync_fn</strong> – Function to be used to perform states synchronization</p></li>
<li><p><strong>process_group</strong> – Specify the process group on which synchronization is called.
default: <cite>None</cite> (which selects the entire world)</p></li>
<li><p><strong>should_sync</strong> – Whether to apply to state synchronization. This will have an impact
only when running in a distributed setting.</p></li>
<li><p><strong>should_unsync</strong> – Whether to restore the cache state so that the metrics can
continue to be accumulated.</p></li>
<li><p><strong>distributed_available</strong> – Function to determine if we are running inside a distributed setting</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_uncertainty.metrics.MutualInformation.type">
<span class="sig-name descname"><span class="pre">type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dst_type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#torch_uncertainty.metrics.MutualInformation.type" title="Permalink to this definition">¶</a></dt>
<dd><p>Override default and prevent dtype casting.</p>
<p>Please use <code class="xref py py-meth docutils literal notranslate"><span class="pre">Metric.set_dtype()</span></code> instead.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_uncertainty.metrics.MutualInformation.unsync">
<span class="sig-name descname"><span class="pre">unsync</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">should_unsync</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#torch_uncertainty.metrics.MutualInformation.unsync" title="Permalink to this definition">¶</a></dt>
<dd><p>Unsync function for manually controlling when metrics states should be reverted back to their local states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>should_unsync</strong> – Whether to perform unsync</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch_uncertainty.metrics.MutualInformation.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">probs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch_uncertainty/metrics/mutual_information.html#MutualInformation.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch_uncertainty.metrics.MutualInformation.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the current mutual information with a new tensor of
probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>probs</strong> (<em>torch.Tensor</em>) – Likelihoods from the ensemble of shape
<span class="math notranslate nohighlight">\((B, N, C)\)</span>, where <span class="math notranslate nohighlight">\(B\)</span> is the batch size,
<span class="math notranslate nohighlight">\(N\)</span> is the number of estimators and <span class="math notranslate nohighlight">\(C\)</span> is the
number of classes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="torch_uncertainty.metrics.MutualInformation.update_called">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_called</span></span><a class="headerlink" href="#torch_uncertainty.metrics.MutualInformation.update_called" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <cite>True</cite> if <cite>update</cite> or <cite>forward</cite> has been called initialization or last <cite>reset</cite>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="torch_uncertainty.metrics.MutualInformation.update_count">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_count</span></span><a class="headerlink" href="#torch_uncertainty.metrics.MutualInformation.update_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of times <cite>update</cite> and/or <cite>forward</cite> has been called since initialization or last <cite>reset</cite>.</p>
</dd></dl>

</dd></dl>

</section>


              </article>
              
            </div>
            <footer>
  
  <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
    
    <a href="torch_uncertainty.metrics.NegativeLogLikelihood.html" class="btn btn-neutral float-right" title="NegativeLogLikelihood" accesskey="n"
      rel="next">Next <img src="../_static/images/chevron-right-teal.svg"
        class="next-page"></a>
    
    
    <a href="torch_uncertainty.metrics.Entropy.html" class="btn btn-neutral" title="Entropy" accesskey="p"
      rel="prev"><img src="../_static/images/chevron-right-teal.svg" class="previous-page"> Previous</a>
    
  </div>
  

  <hr>

  <div role="contentinfo">
    <p>
      &copy; Copyright 2023, Adrien Lafage and Olivier Laurent.

    </p>
  </div>
  
  <div>
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a
      href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the
      Docs</a>.
  </div>
   

</footer>
          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">MutualInformation</a><ul>
<li><a class="reference internal" href="#torch_uncertainty.metrics.MutualInformation"><code class="docutils literal notranslate"><span class="pre">MutualInformation</span></code></a><ul>
<li><a class="reference internal" href="#torch_uncertainty.metrics.MutualInformation.add_state"><code class="docutils literal notranslate"><span class="pre">MutualInformation.add_state()</span></code></a></li>
<li><a class="reference internal" href="#torch_uncertainty.metrics.MutualInformation.clone"><code class="docutils literal notranslate"><span class="pre">MutualInformation.clone()</span></code></a></li>
<li><a class="reference internal" href="#torch_uncertainty.metrics.MutualInformation.compute"><code class="docutils literal notranslate"><span class="pre">MutualInformation.compute()</span></code></a></li>
<li><a class="reference internal" href="#torch_uncertainty.metrics.MutualInformation.device"><code class="docutils literal notranslate"><span class="pre">MutualInformation.device</span></code></a></li>
<li><a class="reference internal" href="#torch_uncertainty.metrics.MutualInformation.double"><code class="docutils literal notranslate"><span class="pre">MutualInformation.double()</span></code></a></li>
<li><a class="reference internal" href="#torch_uncertainty.metrics.MutualInformation.float"><code class="docutils literal notranslate"><span class="pre">MutualInformation.float()</span></code></a></li>
<li><a class="reference internal" href="#torch_uncertainty.metrics.MutualInformation.forward"><code class="docutils literal notranslate"><span class="pre">MutualInformation.forward()</span></code></a></li>
<li><a class="reference internal" href="#torch_uncertainty.metrics.MutualInformation.half"><code class="docutils literal notranslate"><span class="pre">MutualInformation.half()</span></code></a></li>
<li><a class="reference internal" href="#torch_uncertainty.metrics.MutualInformation.metric_state"><code class="docutils literal notranslate"><span class="pre">MutualInformation.metric_state</span></code></a></li>
<li><a class="reference internal" href="#torch_uncertainty.metrics.MutualInformation.persistent"><code class="docutils literal notranslate"><span class="pre">MutualInformation.persistent()</span></code></a></li>
<li><a class="reference internal" href="#torch_uncertainty.metrics.MutualInformation.plot"><code class="docutils literal notranslate"><span class="pre">MutualInformation.plot()</span></code></a></li>
<li><a class="reference internal" href="#torch_uncertainty.metrics.MutualInformation.reset"><code class="docutils literal notranslate"><span class="pre">MutualInformation.reset()</span></code></a></li>
<li><a class="reference internal" href="#torch_uncertainty.metrics.MutualInformation.set_dtype"><code class="docutils literal notranslate"><span class="pre">MutualInformation.set_dtype()</span></code></a></li>
<li><a class="reference internal" href="#torch_uncertainty.metrics.MutualInformation.state_dict"><code class="docutils literal notranslate"><span class="pre">MutualInformation.state_dict()</span></code></a></li>
<li><a class="reference internal" href="#torch_uncertainty.metrics.MutualInformation.sync"><code class="docutils literal notranslate"><span class="pre">MutualInformation.sync()</span></code></a></li>
<li><a class="reference internal" href="#torch_uncertainty.metrics.MutualInformation.sync_context"><code class="docutils literal notranslate"><span class="pre">MutualInformation.sync_context()</span></code></a></li>
<li><a class="reference internal" href="#torch_uncertainty.metrics.MutualInformation.type"><code class="docutils literal notranslate"><span class="pre">MutualInformation.type()</span></code></a></li>
<li><a class="reference internal" href="#torch_uncertainty.metrics.MutualInformation.unsync"><code class="docutils literal notranslate"><span class="pre">MutualInformation.unsync()</span></code></a></li>
<li><a class="reference internal" href="#torch_uncertainty.metrics.MutualInformation.update"><code class="docutils literal notranslate"><span class="pre">MutualInformation.update()</span></code></a></li>
<li><a class="reference internal" href="#torch_uncertainty.metrics.MutualInformation.update_called"><code class="docutils literal notranslate"><span class="pre">MutualInformation.update_called</span></code></a></li>
<li><a class="reference internal" href="#torch_uncertainty.metrics.MutualInformation.update_count"><code class="docutils literal notranslate"><span class="pre">MutualInformation.update_count</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
    </section>
  </div>

  


  

  
  <script type="text/javascript" id="documentation_options" data-url_root="../"
    src="../_static/documentation_options.js"></script>
  <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
  <script src="../_static/jquery.js"></script>
  <script src="../_static/underscore.js"></script>
  <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
  <script src="../_static/doctools.js"></script>
  <script src="../_static/sphinx_highlight.js"></script>
  <script src="../_static/clipboard.min.js"></script>
  <script src="../_static/copybutton.js"></script>
  <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  

  

  <script type="text/javascript" src="../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
  </div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://torch-uncertainty.github.io/" aria-label="OpenMMLab"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://github.com/ENSTA-U2IS/torch-uncertainty" target="_blank">GitHub</a>
          </li>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function () {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function (e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>

</html>