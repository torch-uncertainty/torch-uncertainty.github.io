
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_tutorials/tutorial_corruptions.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_tutorials_tutorial_corruptions.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_tutorials_tutorial_corruptions.py:


Image Corruptions
=================

This tutorial shows the impact of the different corruptions available in the
TorchUncertainty library. These corruptions were first proposed in the paper
Benchmarking Neural Network Robustness to Common Corruptions and Perturbations
by Dan Hendrycks and Thomas Dietterich.

For this tutorial, we will only load the corruption transforms available in 
torch_uncertainty.transforms.corruptions. We also need to load utilities from
torchvision and matplotlib.

.. GENERATED FROM PYTHON SOURCE LINES 14-42

.. code-block:: Python

    import torch
    from torchvision.datasets import CIFAR10
    from torchvision.transforms import Compose, ToTensor, Resize

    from torchvision.utils import make_grid
    import matplotlib.pyplot as plt
    plt.axis('off')
    ds = CIFAR10("./data", train=False, download=True)

    def get_images(main_transform, severity):
        ds_transforms = Compose([ToTensor(), main_transform(severity), Resize(256)])
        ds = CIFAR10("./data", train=False, download=False, transform=ds_transforms)
        return make_grid([ds[i][0] for i in range(6)]).permute(1, 2, 0)

    def show_images(transform):
        print("Original Images")
        with torch.no_grad():
            plt.axis('off')
            plt.imshow(get_images(transform, 0))
            plt.show()

        for severity in range(1, 6):
            print(f"Severity {severity}")
            with torch.no_grad():
                plt.axis('off')
                plt.imshow(get_images(transform, severity))
                plt.show()




.. image-sg:: /auto_tutorials/images/sphx_glr_tutorial_corruptions_001.png
   :alt: tutorial corruptions
   :srcset: /auto_tutorials/images/sphx_glr_tutorial_corruptions_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to ./data/cifar-10-python.tar.gz
      0%|          | 0/170498071 [00:00<?, ?it/s]      1%|          | 2064384/170498071 [00:00<00:08, 20619279.57it/s]      7%|▋         | 11665408/170498071 [00:00<00:02, 64840310.43it/s]     13%|█▎        | 21725184/170498071 [00:00<00:01, 81068601.55it/s]     18%|█▊        | 31424512/170498071 [00:00<00:01, 87277890.64it/s]     24%|██▍       | 41746432/170498071 [00:00<00:01, 92943220.34it/s]     30%|███       | 51216384/170498071 [00:00<00:01, 93484759.20it/s]     36%|███▌      | 61571072/170498071 [00:00<00:01, 96548945.70it/s]     42%|████▏     | 71237632/170498071 [00:00<00:01, 96581413.29it/s]     48%|████▊     | 81264640/170498071 [00:00<00:00, 97655118.77it/s]     53%|█████▎    | 91062272/170498071 [00:01<00:00, 97007364.37it/s]     60%|█████▉    | 101580800/170498071 [00:01<00:00, 99408390.42it/s]     65%|██████▌   | 111542272/170498071 [00:01<00:00, 97708433.89it/s]     71%|███████▏  | 121733120/170498071 [00:01<00:00, 98939020.47it/s]     77%|███████▋  | 131760128/170498071 [00:01<00:00, 99282310.84it/s]     83%|████████▎ | 141721600/170498071 [00:01<00:00, 99083991.26it/s]     89%|████████▉ | 151748608/170498071 [00:01<00:00, 99432041.16it/s]     95%|█████████▍| 161710080/170498071 [00:01<00:00, 98911295.57it/s]    100%|██████████| 170498071/170498071 [00:01<00:00, 94684895.69it/s]
    Extracting ./data/cifar-10-python.tar.gz to ./data




.. GENERATED FROM PYTHON SOURCE LINES 43-45

1. Gaussian Noise
~~~~~~~~~~~~~~~~~

.. GENERATED FROM PYTHON SOURCE LINES 45-49

.. code-block:: Python

    from torch_uncertainty.transforms.corruptions import GaussianNoise

    show_images(GaussianNoise)




.. image-sg:: /auto_tutorials/images/sphx_glr_tutorial_corruptions_002.png
   :alt: tutorial corruptions
   :srcset: /auto_tutorials/images/sphx_glr_tutorial_corruptions_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Original Images
    /opt/hostedtoolcache/Python/3.10.13/x64/lib/python3.10/site-packages/torchvision/transforms/functional.py:1603: UserWarning: The default value of the antialias parameter of all the resizing transforms (Resize(), RandomResizedCrop(), etc.) will change from None to True in v0.17, in order to be consistent across the PIL and Tensor backends. To suppress this warning, directly pass antialias=True (recommended, future default), antialias=None (current default, which means False for Tensors and True for PIL), or antialias=False (only works on Tensors - PIL will still use antialiasing). This also applies if you are using the inference transforms from the models weights: update the call to weights.transforms(antialias=True).
      warnings.warn(
    Severity 1
    Severity 2
    Severity 3
    Severity 4
    Severity 5




.. GENERATED FROM PYTHON SOURCE LINES 50-52

2. Shot Noise
~~~~~~~~~~~~~

.. GENERATED FROM PYTHON SOURCE LINES 52-56

.. code-block:: Python

    from torch_uncertainty.transforms.corruptions import ShotNoise

    show_images(ShotNoise)




.. image-sg:: /auto_tutorials/images/sphx_glr_tutorial_corruptions_003.png
   :alt: tutorial corruptions
   :srcset: /auto_tutorials/images/sphx_glr_tutorial_corruptions_003.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Original Images
    Severity 1
    Severity 2
    Severity 3
    Severity 4
    Severity 5




.. GENERATED FROM PYTHON SOURCE LINES 57-59

3. Impulse Noise
~~~~~~~~~~~~~~~~

.. GENERATED FROM PYTHON SOURCE LINES 59-63

.. code-block:: Python

    from torch_uncertainty.transforms.corruptions import ImpulseNoise

    show_images(ImpulseNoise)




.. image-sg:: /auto_tutorials/images/sphx_glr_tutorial_corruptions_004.png
   :alt: tutorial corruptions
   :srcset: /auto_tutorials/images/sphx_glr_tutorial_corruptions_004.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Original Images
    Severity 1
    Severity 2
    Severity 3
    Severity 4
    Severity 5




.. GENERATED FROM PYTHON SOURCE LINES 64-66

4. Speckle Noise
~~~~~~~~~~~~~~~~

.. GENERATED FROM PYTHON SOURCE LINES 66-70

.. code-block:: Python

    from torch_uncertainty.transforms.corruptions import SpeckleNoise

    show_images(SpeckleNoise)




.. image-sg:: /auto_tutorials/images/sphx_glr_tutorial_corruptions_005.png
   :alt: tutorial corruptions
   :srcset: /auto_tutorials/images/sphx_glr_tutorial_corruptions_005.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Original Images
    Severity 1
    Severity 2
    Severity 3
    Severity 4
    Severity 5




.. GENERATED FROM PYTHON SOURCE LINES 71-73

5. Gaussian Blur
~~~~~~~~~~~~~~~~

.. GENERATED FROM PYTHON SOURCE LINES 73-77

.. code-block:: Python

    from torch_uncertainty.transforms.corruptions import GaussianBlur

    show_images(GaussianBlur)




.. image-sg:: /auto_tutorials/images/sphx_glr_tutorial_corruptions_006.png
   :alt: tutorial corruptions
   :srcset: /auto_tutorials/images/sphx_glr_tutorial_corruptions_006.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Original Images
    Severity 1
    Severity 2
    Severity 3
    Severity 4
    Severity 5




.. GENERATED FROM PYTHON SOURCE LINES 78-80

6. Glass Blur
~~~~~~~~~~~~~

.. GENERATED FROM PYTHON SOURCE LINES 80-84

.. code-block:: Python

    from torch_uncertainty.transforms.corruptions import GlassBlur

    show_images(GlassBlur)




.. image-sg:: /auto_tutorials/images/sphx_glr_tutorial_corruptions_007.png
   :alt: tutorial corruptions
   :srcset: /auto_tutorials/images/sphx_glr_tutorial_corruptions_007.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Original Images
    Severity 1
    Severity 2
    Severity 3
    Severity 4
    Severity 5




.. GENERATED FROM PYTHON SOURCE LINES 85-87

7. Defocus Blur
~~~~~~~~~~~~~~~

.. GENERATED FROM PYTHON SOURCE LINES 87-92

.. code-block:: Python


    from torch_uncertainty.transforms.corruptions import DefocusBlur

    show_images(DefocusBlur)




.. image-sg:: /auto_tutorials/images/sphx_glr_tutorial_corruptions_008.png
   :alt: tutorial corruptions
   :srcset: /auto_tutorials/images/sphx_glr_tutorial_corruptions_008.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Original Images
    Severity 1
    Severity 2
    Severity 3
    Severity 4
    Severity 5




.. GENERATED FROM PYTHON SOURCE LINES 93-95

8. JPEG Compression
~~~~~~~~~~~~~~

.. GENERATED FROM PYTHON SOURCE LINES 95-99

.. code-block:: Python

    from torch_uncertainty.transforms.corruptions import JPEGCompression

    show_images(JPEGCompression)




.. image-sg:: /auto_tutorials/images/sphx_glr_tutorial_corruptions_009.png
   :alt: tutorial corruptions
   :srcset: /auto_tutorials/images/sphx_glr_tutorial_corruptions_009.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Original Images
    Severity 1
    Severity 2
    Severity 3
    Severity 4
    Severity 5




.. GENERATED FROM PYTHON SOURCE LINES 100-102

9. Pixelate
~~~~~~~~~~~

.. GENERATED FROM PYTHON SOURCE LINES 102-106

.. code-block:: Python

    from torch_uncertainty.transforms.corruptions import Pixelate

    show_images(Pixelate)




.. image-sg:: /auto_tutorials/images/sphx_glr_tutorial_corruptions_010.png
   :alt: tutorial corruptions
   :srcset: /auto_tutorials/images/sphx_glr_tutorial_corruptions_010.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Original Images
    Severity 1
    Severity 2
    Severity 3
    Severity 4
    Severity 5




.. GENERATED FROM PYTHON SOURCE LINES 107-109

10. Frost
~~~~~~~~

.. GENERATED FROM PYTHON SOURCE LINES 109-113

.. code-block:: Python

    from torch_uncertainty.transforms.corruptions import Frost

    show_images(Frost)




.. image-sg:: /auto_tutorials/images/sphx_glr_tutorial_corruptions_011.png
   :alt: tutorial corruptions
   :srcset: /auto_tutorials/images/sphx_glr_tutorial_corruptions_011.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Original Images
    Downloading https://zenodo.org/records/10438904/files/frost.zip to data/frost.zip
      0%|          | 0/1780178 [00:00<?, ?it/s]      2%|▏         | 32768/1780178 [00:00<00:05, 292088.34it/s]      4%|▎         | 65536/1780178 [00:00<00:05, 291026.34it/s]      6%|▌         | 98304/1780178 [00:00<00:05, 290906.54it/s]      7%|▋         | 131072/1780178 [00:00<00:05, 290856.85it/s]     11%|█         | 196608/1780178 [00:00<00:04, 395385.97it/s]     22%|██▏       | 393216/1780178 [00:00<00:01, 853138.72it/s]     40%|████      | 720896/1780178 [00:00<00:00, 1523433.25it/s]     79%|███████▉  | 1409024/1780178 [00:00<00:00, 2979863.50it/s]    100%|██████████| 1780178/1780178 [00:00<00:00, 1970012.58it/s]
    Extracting data/frost.zip to data
    Downloaded frost.zip to data
    Severity 1
    Files already downloaded and verified
    Severity 2
    Files already downloaded and verified
    Severity 3
    Files already downloaded and verified
    Severity 4
    Files already downloaded and verified
    Severity 5
    Files already downloaded and verified




.. GENERATED FROM PYTHON SOURCE LINES 114-118

Reference
---------

- **Benchmarking Neural Network Robustness to Common Corruptions and Perturbations**, Dan Hendrycks and Thomas Dietterich. `ICLR 2019 <https://arxiv.org/pdf/1903.12261>`_.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 27.889 seconds)


.. _sphx_glr_download_auto_tutorials_tutorial_corruptions.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: tutorial_corruptions.ipynb <tutorial_corruptions.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: tutorial_corruptions.py <tutorial_corruptions.py>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
