
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_tutorials/tutorial_corruptions.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_tutorials_tutorial_corruptions.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_tutorials_tutorial_corruptions.py:


Image Corruptions
=================

This tutorial shows the impact of the different corruptions available in the
TorchUncertainty library. These corruptions were first proposed in the paper
Benchmarking Neural Network Robustness to Common Corruptions and Perturbations
by Dan Hendrycks and Thomas Dietterich.

For this tutorial, we will only load the corruption transforms available in 
torch_uncertainty.transforms.corruptions. We also need to load utilities from
torchvision and matplotlib.

.. GENERATED FROM PYTHON SOURCE LINES 14-63

.. code-block:: Python


    import torch
    from torchvision.datasets import CIFAR10
    from torchvision.transforms import Compose, ToTensor, Resize

    from torchvision.utils import make_grid
    import matplotlib.pyplot as plt

    ds = CIFAR10("./data", train=False, download=True)


    def get_images(main_corruption, index: int = 0):
        """Create an image showing the 6 levels of corruption of a given transform."""
        images = []
        for severity in range(6):
            ds_transforms = Compose(
                [ToTensor(), main_corruption(severity), Resize(256, antialias=True)]
            )
            ds = CIFAR10("./data", train=False, download=False, transform=ds_transforms)
            images.append(ds[index][0].permute(1, 2, 0).numpy())
        return images


    def show_images(transforms):
        """Show the effect of all given transforms."""
        num_corruptions = len(transforms)
        _, ax = plt.subplots(num_corruptions, 6, figsize=(10, int(1.5 * num_corruptions)))
        for i, transform in enumerate(transforms):
            images = get_images(transform, index=i)
            ax[i][0].text(
                -0.1,
                0.5,
                transform.__name__,
                transform=ax[i][0].transAxes,
                rotation="vertical",
                horizontalalignment="right",
                verticalalignment="center",
                fontsize=12,
            )
            for j in range(6):
                ax[i][j].imshow(images[j])
                if i == 0 and j == 0:
                    ax[i][j].set_title("Original")
                elif i == 0:
                    ax[i][j].set_title(f"Severity {j}")
                ax[i][j].axis("off")
        plt.show()






.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to ./data/cifar-10-python.tar.gz
      0%|          | 0/170498071 [00:00<?, ?it/s]      0%|          | 32768/170498071 [00:00<11:18, 251250.33it/s]      0%|          | 229376/170498071 [00:00<02:53, 983277.12it/s]      1%|          | 917504/170498071 [00:00<00:57, 2937574.18it/s]      2%|▏         | 3637248/170498071 [00:00<00:16, 10010864.91it/s]      5%|▌         | 8814592/170498071 [00:00<00:07, 22598772.00it/s]      8%|▊         | 12976128/170498071 [00:00<00:05, 27526463.38it/s]     10%|█         | 17760256/170498071 [00:00<00:04, 33511900.51it/s]     13%|█▎        | 22183936/170498071 [00:00<00:04, 36186162.65it/s]     16%|█▌        | 26836992/170498071 [00:01<00:03, 38963357.19it/s]     18%|█▊        | 31457280/170498071 [00:01<00:03, 40850486.91it/s]     21%|██        | 36208640/170498071 [00:01<00:03, 42088376.93it/s]     24%|██▍       | 40861696/170498071 [00:01<00:02, 43275004.45it/s]     27%|██▋       | 45613056/170498071 [00:01<00:02, 44279220.74it/s]     29%|██▉       | 50266112/170498071 [00:01<00:02, 43816703.20it/s]     32%|███▏      | 55017472/170498071 [00:01<00:02, 44887606.51it/s]     35%|███▍      | 59670528/170498071 [00:01<00:02, 45352866.33it/s]     38%|███▊      | 64225280/170498071 [00:01<00:02, 44096847.61it/s]     41%|████      | 69140480/170498071 [00:01<00:02, 45054567.38it/s]     43%|████▎     | 73859072/170498071 [00:02<00:02, 45644577.47it/s]     46%|████▌     | 78446592/170498071 [00:02<00:02, 45321608.53it/s]     49%|████▊     | 83001344/170498071 [00:02<00:01, 44805369.62it/s]     51%|█████▏    | 87654400/170498071 [00:02<00:01, 45297346.88it/s]     54%|█████▍    | 92209152/170498071 [00:02<00:01, 43593584.74it/s]     57%|█████▋    | 96731136/170498071 [00:02<00:01, 44047481.92it/s]     59%|█████▉    | 101154816/170498071 [00:02<00:01, 43512272.61it/s]     62%|██████▏   | 105545728/170498071 [00:02<00:01, 42989446.77it/s]     64%|██████▍   | 109871104/170498071 [00:02<00:01, 42021787.30it/s]     68%|██████▊   | 115212288/170498071 [00:03<00:01, 45173642.58it/s]     70%|███████   | 119767040/170498071 [00:03<00:01, 42780322.68it/s]     73%|███████▎  | 124944384/170498071 [00:03<00:01, 45275848.16it/s]     76%|███████▌  | 129531904/170498071 [00:03<00:00, 42843713.29it/s]     79%|███████▊  | 133955584/170498071 [00:03<00:00, 43230954.42it/s]     81%|████████▏ | 138543104/170498071 [00:03<00:00, 43970658.96it/s]     84%|████████▍ | 143097856/170498071 [00:03<00:00, 44412249.42it/s]     87%|████████▋ | 147587072/170498071 [00:03<00:00, 41251983.07it/s]     89%|████████▉ | 152010752/170498071 [00:03<00:00, 42066394.02it/s]     92%|█████████▏| 156368896/170498071 [00:03<00:00, 42495199.65it/s]     94%|█████████▍| 160661504/170498071 [00:04<00:00, 42420209.92it/s]     97%|█████████▋| 165445632/170498071 [00:04<00:00, 42892432.99it/s]    100%|█████████▉| 170033152/170498071 [00:04<00:00, 43140943.70it/s]    100%|██████████| 170498071/170498071 [00:04<00:00, 39619865.38it/s]
    Extracting ./data/cifar-10-python.tar.gz to ./data




.. GENERATED FROM PYTHON SOURCE LINES 64-66

1. Noise Corruptions
~~~~~~~~~~~~~~~~~~~~

.. GENERATED FROM PYTHON SOURCE LINES 66-82

.. code-block:: Python

    from torch_uncertainty.transforms.corruptions import (
        GaussianNoise,
        ShotNoise,
        ImpulseNoise,
        SpeckleNoise,
    )

    show_images(
        [
            GaussianNoise,
            ShotNoise,
            ImpulseNoise,
            SpeckleNoise,
        ]
    )




.. image-sg:: /auto_tutorials/images/sphx_glr_tutorial_corruptions_001.png
   :alt: Original, Severity 1, Severity 2, Severity 3, Severity 4, Severity 5
   :srcset: /auto_tutorials/images/sphx_glr_tutorial_corruptions_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 83-85

2. Blur Corruptions
~~~~~~~~~~~~~~~~~~~~

.. GENERATED FROM PYTHON SOURCE LINES 85-99

.. code-block:: Python

    from torch_uncertainty.transforms.corruptions import (
        GaussianBlur,
        GlassBlur,
        DefocusBlur,
    )

    show_images(
        [
            GaussianBlur,
            GlassBlur,
            DefocusBlur,
        ]
    )




.. image-sg:: /auto_tutorials/images/sphx_glr_tutorial_corruptions_002.png
   :alt: Original, Severity 1, Severity 2, Severity 3, Severity 4, Severity 5
   :srcset: /auto_tutorials/images/sphx_glr_tutorial_corruptions_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 100-102

3. Other Corruptions
~~~~~~~~~~~~~~~~~~~~

.. GENERATED FROM PYTHON SOURCE LINES 102-116

.. code-block:: Python

    from torch_uncertainty.transforms.corruptions import (
        JPEGCompression,
        Pixelate,
        Frost,
    )

    show_images(
        [
            JPEGCompression,
            Pixelate,
            Frost,
        ]
    )




.. image-sg:: /auto_tutorials/images/sphx_glr_tutorial_corruptions_003.png
   :alt: Original, Severity 1, Severity 2, Severity 3, Severity 4, Severity 5
   :srcset: /auto_tutorials/images/sphx_glr_tutorial_corruptions_003.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Downloading https://zenodo.org/records/10438904/files/frost.zip to data/frost.zip
      0%|          | 0/1780178 [00:00<?, ?it/s]      2%|▏         | 32768/1780178 [00:00<00:07, 223513.59it/s]      4%|▎         | 65536/1780178 [00:00<00:07, 225666.78it/s]      9%|▉         | 163840/1780178 [00:00<00:03, 432995.25it/s]     17%|█▋        | 294912/1780178 [00:00<00:02, 617619.44it/s]     35%|███▍      | 622592/1780178 [00:00<00:00, 1213013.14it/s]     72%|███████▏  | 1277952/1780178 [00:00<00:00, 2340520.44it/s]    100%|██████████| 1780178/1780178 [00:00<00:00, 2042906.21it/s]
    Extracting data/frost.zip to data
    Downloaded frost.zip to data
    Files already downloaded and verified
    Files already downloaded and verified
    Files already downloaded and verified
    Files already downloaded and verified
    Files already downloaded and verified




.. GENERATED FROM PYTHON SOURCE LINES 117-121

Reference
---------

- **Benchmarking Neural Network Robustness to Common Corruptions and Perturbations**, Dan Hendrycks and Thomas Dietterich. `ICLR 2019 <https://arxiv.org/pdf/1903.12261>`_.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 28.310 seconds)


.. _sphx_glr_download_auto_tutorials_tutorial_corruptions.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: tutorial_corruptions.ipynb <tutorial_corruptions.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: tutorial_corruptions.py <tutorial_corruptions.py>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
