


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Corrupting Images with TorchUncertainty to Benchmark Robustness &mdash; TorchUncertainty 0.2.2.post2 documentation</title>
  

  <link rel="shortcut icon" href="../_static/images/logo_torch_uncertainty.png" />
  
  

  

  
  
  

  

  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sphinx-codeautolink.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sg_gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sg_gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sg_gallery-rendered-html.css" type="text/css" />
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="next" title="Train a Bayesian Neural Network in Three Minutes" href="tutorial_bayesian.html" />
  <link rel="prev" title="Deep Evidential Regression on a Toy Example" href="tutorial_der_cubic.html" />
  <!-- Google Analytics -->
  <script type="text/javascript">
    var collapsedSections = [];
  </script>
  
  <!-- End Google Analytics -->
  

  
  <script src="../_static/js/modernizr.min.js"></script>
  <script>
    MathJax = {
        chtml: {
            scale: 1,
            minScale: 1,
        },
        svg: {
            scale: 1,
            minScale: 1,
        }
    }
</script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"
    integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://torch-uncertainty.github.io/"
        aria-label="OpenMMLab"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://github.com/ENSTA-U2IS-AI/torch-uncertainty" target="_blank">GitHub</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>
  </div>
</div>

<body class="pytorch-body">

   

  

  <div class="table-of-contents-link-wrapper">
    <span>Table of Contents</span>
    <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
  </div>

  <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
    <div class="pytorch-side-scroll">
      <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <div class="pytorch-left-menu-search">
          

          
          
          
          

          



<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        
        
        
        
        
        <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli_guide.html">CLI Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

        
        
      </div>
    </div>
  </nav>

  <div class="pytorch-container">
    <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
      <div class="pytorch-breadcrumbs-wrapper">
        















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
    <li>
      <a href="../index.html">
        Docs
      </a> &gt;
    </li>

    
    <li><a href="index.html">Tutorials</a> &gt;</li>
    
    <li>Corrupting Images with TorchUncertainty to Benchmark Robustness</li>
    
    <!-- 
    <li class="pytorch-breadcrumbs-aside">
      
      
      
      
      
      <a href="/zh_CN//auto_tutorials/tutorial_corruption.html" class="fa fa-language"> 以中文阅读</a>
      
      
    </li>
    
     -->
  </ul>

  
</div>
      </div>

      <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
        Shortcuts
      </div>
    </div>

    <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
      <div class="pytorch-content-left">

        

        <div class="pytorch-call-to-action-links">
          <div id="tutorial-type">auto_tutorials/tutorial_corruption</div>

          <!-- <div id="google-colab-link">
            <img class="call-to-action-img" src="../_static/images/pytorch-colab.svg" />
            <div class="call-to-action-desktop-view">Run in Google Colab</div>
            <div class="call-to-action-mobile-view">Colab</div>
          </div> -->
          <div id="download-notebook-link">
            <img class="call-to-action-notebook-img" src="../_static/images/pytorch-download.svg" />
            <div class="call-to-action-desktop-view">Download Notebook</div>
            <div class="call-to-action-mobile-view">Notebook</div>
          </div>
          <div id="github-view-link">
            <img class="call-to-action-img" src="../_static/images/pytorch-github.svg" />
            <div class="call-to-action-desktop-view">View on GitHub</div>
            <div class="call-to-action-mobile-view">GitHub</div>
          </div>
        </div>

        
        
          <div class="rst-content">
            
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
              <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
                
                
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-tutorials-tutorial-corruption-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="corrupting-images-with-torchuncertainty-to-benchmark-robustness">
<span id="sphx-glr-auto-tutorials-tutorial-corruption-py"></span><h1>Corrupting Images with TorchUncertainty to Benchmark Robustness<a class="headerlink" href="#corrupting-images-with-torchuncertainty-to-benchmark-robustness" title="Permalink to this heading">¶</a></h1>
<p>This tutorial shows the impact of the different corruption transforms available in the
TorchUncertainty library. These corruption transforms were first proposed in the paper
Benchmarking Neural Network Robustness to Common Corruptions and Perturbations
by Dan Hendrycks and Thomas Dietterich.</p>
<p>For this tutorial, we will only load the corruption transforms available in
torch_uncertainty.transforms.corruption. We also need to load utilities from
torchvision and matplotlib.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">torchvision.datasets</span> <span class="kn">import</span> <span class="n">CIFAR10</span>
<span class="kn">from</span> <span class="nn">torchvision.transforms</span> <span class="kn">import</span> <span class="n">Compose</span><span class="p">,</span> <span class="n">ToTensor</span><span class="p">,</span> <span class="n">Resize</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">CIFAR10</span><span class="p">(</span><span class="s2">&quot;./data&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_images</span><span class="p">(</span><span class="n">main_corruption</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an image showing the 6 levels of corruption of a given transform.&quot;&quot;&quot;</span>
    <span class="n">images</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">severity</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
        <span class="n">ds_transforms</span> <span class="o">=</span> <span class="n">Compose</span><span class="p">(</span>
            <span class="p">[</span><span class="n">ToTensor</span><span class="p">(),</span> <span class="n">main_corruption</span><span class="p">(</span><span class="n">severity</span><span class="p">),</span> <span class="n">Resize</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="n">antialias</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
        <span class="p">)</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">CIFAR10</span><span class="p">(</span><span class="s2">&quot;./data&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ds_transforms</span><span class="p">)</span>
        <span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">images</span>


<span class="k">def</span> <span class="nf">show_images</span><span class="p">(</span><span class="n">transforms</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Show the effect of all given transforms.&quot;&quot;&quot;</span>
    <span class="n">num_corruptions</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">transforms</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">num_corruptions</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1.5</span> <span class="o">*</span> <span class="n">num_corruptions</span><span class="p">)))</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">transform</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">transforms</span><span class="p">):</span>
        <span class="n">images</span> <span class="o">=</span> <span class="n">get_images</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span>
            <span class="mf">0.5</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
            <span class="n">rotation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span>
            <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">images</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Original&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Severity </span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to ./data/cifar-10-python.tar.gz

  0%|          | 0/170498071 [00:00&lt;?, ?it/s]
  0%|          | 98304/170498071 [00:00&lt;04:29, 631465.81it/s]
  0%|          | 229376/170498071 [00:00&lt;03:27, 819818.24it/s]
  0%|          | 360448/170498071 [00:00&lt;02:59, 946842.69it/s]
  0%|          | 524288/170498071 [00:00&lt;02:31, 1120766.14it/s]
  0%|          | 720896/170498071 [00:00&lt;02:09, 1306928.26it/s]
  1%|          | 917504/170498071 [00:00&lt;01:57, 1449124.03it/s]
  1%|          | 1146880/170498071 [00:00&lt;01:44, 1618455.14it/s]
  1%|          | 1409024/170498071 [00:00&lt;01:32, 1822947.71it/s]
  1%|          | 1703936/170498071 [00:01&lt;01:22, 2047260.27it/s]
  1%|          | 2031616/170498071 [00:01&lt;01:13, 2286132.52it/s]
  1%|▏         | 2359296/170498071 [00:01&lt;01:08, 2451564.14it/s]
  2%|▏         | 2752512/170498071 [00:01&lt;01:01, 2723141.05it/s]
  2%|▏         | 3145728/170498071 [00:01&lt;00:57, 2926287.71it/s]
  2%|▏         | 3571712/170498071 [00:01&lt;00:52, 3156322.35it/s]
  2%|▏         | 3997696/170498071 [00:01&lt;00:50, 3329587.35it/s]
  3%|▎         | 4456448/170498071 [00:01&lt;00:45, 3653189.28it/s]
  3%|▎         | 4882432/170498071 [00:02&lt;00:44, 3725251.21it/s]
  3%|▎         | 5373952/170498071 [00:02&lt;00:40, 4027863.61it/s]
  3%|▎         | 5865472/170498071 [00:02&lt;00:39, 4170217.74it/s]
  4%|▎         | 6389760/170498071 [00:02&lt;00:37, 4414863.83it/s]
  4%|▍         | 6914048/170498071 [00:02&lt;00:35, 4566506.59it/s]
  4%|▍         | 7471104/170498071 [00:02&lt;00:34, 4793679.34it/s]
  5%|▍         | 8060928/170498071 [00:02&lt;00:32, 4997012.06it/s]
  5%|▌         | 8617984/170498071 [00:02&lt;00:31, 5158203.58it/s]
  5%|▌         | 9240576/170498071 [00:02&lt;00:29, 5439102.62it/s]
  6%|▌         | 9895936/170498071 [00:02&lt;00:28, 5596940.21it/s]
  6%|▌         | 10551296/170498071 [00:03&lt;00:27, 5824018.09it/s]
  7%|▋         | 11272192/170498071 [00:03&lt;00:26, 5993070.01it/s]
  7%|▋         | 12025856/170498071 [00:03&lt;00:24, 6420661.52it/s]
  7%|▋         | 12713984/170498071 [00:03&lt;00:24, 6418791.20it/s]
  8%|▊         | 13434880/170498071 [00:03&lt;00:23, 6626573.35it/s]
  8%|▊         | 14155776/170498071 [00:03&lt;00:23, 6794931.08it/s]
  9%|▉         | 14974976/170498071 [00:03&lt;00:22, 7034440.70it/s]
  9%|▉         | 15761408/170498071 [00:03&lt;00:21, 7148679.45it/s]
 10%|▉         | 16646144/170498071 [00:03&lt;00:20, 7493606.17it/s]
 10%|█         | 17465344/170498071 [00:04&lt;00:20, 7569633.51it/s]
 11%|█         | 18251776/170498071 [00:04&lt;00:19, 7653701.15it/s]
 11%|█▏        | 19202048/170498071 [00:04&lt;00:18, 8084856.06it/s]
 12%|█▏        | 20119552/170498071 [00:04&lt;00:18, 8195628.68it/s]
 12%|█▏        | 21069824/170498071 [00:04&lt;00:17, 8470544.56it/s]
 13%|█▎        | 22020096/170498071 [00:04&lt;00:17, 8492164.31it/s]
 13%|█▎        | 22937600/170498071 [00:04&lt;00:17, 8628383.68it/s]
 14%|█▍        | 23986176/170498071 [00:04&lt;00:16, 9150614.58it/s]
 15%|█▍        | 25034752/170498071 [00:04&lt;00:15, 9169499.10it/s]
 15%|█▌        | 26050560/170498071 [00:04&lt;00:15, 9440492.08it/s]
 16%|█▌        | 27230208/170498071 [00:05&lt;00:14, 9677598.04it/s]
 17%|█▋        | 28409856/170498071 [00:05&lt;00:14, 9967930.00it/s]
 17%|█▋        | 29491200/170498071 [00:05&lt;00:13, 10142132.75it/s]
 18%|█▊        | 30670848/170498071 [00:05&lt;00:13, 10609527.98it/s]
 19%|█▊        | 31752192/170498071 [00:05&lt;00:13, 10432420.87it/s]
 19%|█▉        | 32866304/170498071 [00:05&lt;00:13, 10550896.93it/s]
 20%|██        | 34111488/170498071 [00:05&lt;00:12, 11081419.68it/s]
 21%|██        | 35225600/170498071 [00:05&lt;00:12, 10866404.15it/s]
 21%|██▏       | 36405248/170498071 [00:05&lt;00:12, 11114562.30it/s]
 22%|██▏       | 37683200/170498071 [00:06&lt;00:11, 11592387.00it/s]
 23%|██▎       | 38961152/170498071 [00:06&lt;00:11, 11654495.31it/s]
 24%|██▎       | 40173568/170498071 [00:06&lt;00:11, 11771320.96it/s]
 24%|██▍       | 41484288/170498071 [00:06&lt;00:10, 12140634.59it/s]
 25%|██▌       | 42860544/170498071 [00:06&lt;00:10, 12594261.62it/s]
 26%|██▌       | 44171264/170498071 [00:06&lt;00:10, 12343901.33it/s]
 27%|██▋       | 45547520/170498071 [00:06&lt;00:09, 12753752.19it/s]
 28%|██▊       | 46923776/170498071 [00:06&lt;00:09, 13028428.65it/s]
 28%|██▊       | 48300032/170498071 [00:06&lt;00:09, 12823594.65it/s]
 29%|██▉       | 49774592/170498071 [00:06&lt;00:09, 13351659.05it/s]
 30%|███       | 51249152/170498071 [00:07&lt;00:08, 13457600.65it/s]
 31%|███       | 52658176/170498071 [00:07&lt;00:08, 13558997.23it/s]
 32%|███▏      | 54099968/170498071 [00:07&lt;00:08, 13807584.51it/s]
 33%|███▎      | 55640064/170498071 [00:07&lt;00:08, 13993806.64it/s]
 34%|███▎      | 57147392/170498071 [00:07&lt;00:07, 14269389.60it/s]
 34%|███▍      | 58621952/170498071 [00:07&lt;00:07, 14396607.87it/s]
 35%|███▌      | 60162048/170498071 [00:07&lt;00:07, 14654010.77it/s]
 36%|███▌      | 61734912/170498071 [00:07&lt;00:07, 14698892.17it/s]
 37%|███▋      | 63340544/170498071 [00:07&lt;00:07, 14973163.12it/s]
 38%|███▊      | 64978944/170498071 [00:07&lt;00:06, 15311336.26it/s]
 39%|███▉      | 66551808/170498071 [00:08&lt;00:06, 15189636.02it/s]
 40%|████      | 68222976/170498071 [00:08&lt;00:06, 15583206.27it/s]
 41%|████      | 69861376/170498071 [00:08&lt;00:06, 15683692.88it/s]
 42%|████▏     | 71630848/170498071 [00:08&lt;00:06, 15871434.28it/s]
 43%|████▎     | 73367552/170498071 [00:08&lt;00:05, 16204603.43it/s]
 44%|████▍     | 75038720/170498071 [00:08&lt;00:05, 16183362.74it/s]
 45%|████▌     | 76775424/170498071 [00:08&lt;00:05, 16351882.77it/s]
 46%|████▌     | 78610432/170498071 [00:08&lt;00:05, 16916190.26it/s]
 47%|████▋     | 80379904/170498071 [00:08&lt;00:05, 17105505.01it/s]
 48%|████▊     | 82116608/170498071 [00:08&lt;00:05, 17049862.10it/s]
 49%|████▉     | 83918848/170498071 [00:09&lt;00:05, 17249260.53it/s]
 50%|█████     | 85688320/170498071 [00:09&lt;00:04, 17366596.02it/s]
 51%|█████▏    | 87523328/170498071 [00:09&lt;00:04, 17645259.72it/s]
 52%|█████▏    | 89325568/170498071 [00:09&lt;00:04, 17725730.47it/s]
 54%|█████▎    | 91258880/170498071 [00:09&lt;00:04, 18138802.10it/s]
 55%|█████▍    | 93192192/170498071 [00:09&lt;00:04, 18457685.84it/s]
 56%|█████▌    | 95092736/170498071 [00:09&lt;00:04, 18356448.49it/s]
 57%|█████▋    | 96960512/170498071 [00:09&lt;00:04, 18337484.19it/s]
 58%|█████▊    | 99090432/170498071 [00:09&lt;00:03, 19099621.65it/s]
 59%|█████▉    | 101089280/170498071 [00:10&lt;00:03, 19057250.54it/s]
 60%|██████    | 103055360/170498071 [00:10&lt;00:03, 18922178.69it/s]
 62%|██████▏   | 105250816/170498071 [00:10&lt;00:03, 19794860.28it/s]
 63%|██████▎   | 107249664/170498071 [00:10&lt;00:03, 19401521.72it/s]
 64%|██████▍   | 109215744/170498071 [00:10&lt;00:03, 19397678.95it/s]
 65%|██████▌   | 111378432/170498071 [00:10&lt;00:02, 20040955.28it/s]
 67%|██████▋   | 113573888/170498071 [00:10&lt;00:02, 20152647.41it/s]
 68%|██████▊   | 115671040/170498071 [00:10&lt;00:02, 20187716.47it/s]
 69%|██████▉   | 117800960/170498071 [00:10&lt;00:02, 20483108.56it/s]
 70%|███████   | 120029184/170498071 [00:10&lt;00:02, 20998055.10it/s]
 72%|███████▏  | 122224640/170498071 [00:11&lt;00:02, 20924018.59it/s]
 73%|███████▎  | 124420096/170498071 [00:11&lt;00:02, 21076975.91it/s]
 74%|███████▍  | 126615552/170498071 [00:11&lt;00:02, 21264870.71it/s]
 76%|███████▌  | 128843776/170498071 [00:11&lt;00:01, 21557455.65it/s]
 77%|███████▋  | 131268608/170498071 [00:11&lt;00:01, 22333404.94it/s]
 78%|███████▊  | 133529600/170498071 [00:11&lt;00:01, 22273355.71it/s]
 80%|███████▉  | 135790592/170498071 [00:11&lt;00:01, 20378111.08it/s]
 81%|████████  | 137887744/170498071 [00:11&lt;00:01, 19617473.59it/s]
 82%|████████▏ | 139886592/170498071 [00:11&lt;00:01, 18930935.26it/s]
 83%|████████▎ | 141819904/170498071 [00:12&lt;00:01, 18967258.66it/s]
 84%|████████▍ | 143753216/170498071 [00:12&lt;00:01, 18711495.25it/s]
 85%|████████▌ | 145653760/170498071 [00:12&lt;00:01, 18772448.04it/s]
 87%|████████▋ | 147554304/170498071 [00:12&lt;00:01, 18479594.48it/s]
 88%|████████▊ | 149422080/170498071 [00:12&lt;00:01, 18164394.71it/s]
 89%|████████▊ | 151289856/170498071 [00:12&lt;00:01, 18164313.64it/s]
 90%|████████▉ | 153124864/170498071 [00:12&lt;00:00, 18088942.47it/s]
 91%|█████████ | 154959872/170498071 [00:12&lt;00:00, 18090370.72it/s]
 92%|█████████▏| 156860416/170498071 [00:12&lt;00:00, 18307842.25it/s]
 93%|█████████▎| 158728192/170498071 [00:12&lt;00:00, 18325769.33it/s]
 94%|█████████▍| 160694272/170498071 [00:13&lt;00:00, 18698708.07it/s]
 95%|█████████▌| 162594816/170498071 [00:13&lt;00:00, 18715220.97it/s]
 96%|█████████▋| 164495360/170498071 [00:13&lt;00:00, 18727245.12it/s]
 98%|█████████▊| 166494208/170498071 [00:13&lt;00:00, 19071649.22it/s]
 99%|█████████▉| 168427520/170498071 [00:13&lt;00:00, 19041986.66it/s]
100%|█████████▉| 170426368/170498071 [00:13&lt;00:00, 19260569.96it/s]
100%|██████████| 170498071/170498071 [00:13&lt;00:00, 12573917.82it/s]
Extracting ./data/cifar-10-python.tar.gz to ./data
</pre></div>
</div>
<section id="noise-corruptions">
<h2>1. Noise Corruptions<a class="headerlink" href="#noise-corruptions" title="Permalink to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">torch_uncertainty.transforms.corruption</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">GaussianNoise</span><span class="p">,</span>
    <span class="n">ShotNoise</span><span class="p">,</span>
    <span class="n">ImpulseNoise</span><span class="p">,</span>
    <span class="n">SpeckleNoise</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">show_images</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">GaussianNoise</span><span class="p">,</span>
        <span class="n">ShotNoise</span><span class="p">,</span>
        <span class="n">ImpulseNoise</span><span class="p">,</span>
        <span class="n">SpeckleNoise</span><span class="p">,</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_corruption_001.png" srcset="../_images/sphx_glr_tutorial_corruption_001.png" alt="Original, Severity 1, Severity 2, Severity 3, Severity 4, Severity 5" class = "sphx-glr-single-img"/></section>
<section id="blur-corruptions">
<h2>2. Blur Corruptions<a class="headerlink" href="#blur-corruptions" title="Permalink to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">torch_uncertainty.transforms.corruption</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">GaussianBlur</span><span class="p">,</span>
    <span class="n">GlassBlur</span><span class="p">,</span>
    <span class="n">DefocusBlur</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">show_images</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">GaussianBlur</span><span class="p">,</span>
        <span class="n">GlassBlur</span><span class="p">,</span>
        <span class="n">DefocusBlur</span><span class="p">,</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_corruption_002.png" srcset="../_images/sphx_glr_tutorial_corruption_002.png" alt="Original, Severity 1, Severity 2, Severity 3, Severity 4, Severity 5" class = "sphx-glr-single-img"/></section>
<section id="other-corruptions">
<h2>3. Other Corruptions<a class="headerlink" href="#other-corruptions" title="Permalink to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">torch_uncertainty.transforms.corruption</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">JPEGCompression</span><span class="p">,</span>
    <span class="n">Pixelate</span><span class="p">,</span>
    <span class="n">Frost</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">show_images</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">JPEGCompression</span><span class="p">,</span>
        <span class="n">Pixelate</span><span class="p">,</span>
        <span class="n">Frost</span><span class="p">,</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_corruption_003.png" srcset="../_images/sphx_glr_tutorial_corruption_003.png" alt="Original, Severity 1, Severity 2, Severity 3, Severity 4, Severity 5" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Downloading https://zenodo.org/records/10438904/files/frost.zip to data/frost.zip

  0%|          | 0/1780178 [00:00&lt;?, ?it/s]
  4%|▎         | 65536/1780178 [00:00&lt;00:05, 341280.52it/s]
 15%|█▍        | 262144/1780178 [00:00&lt;00:02, 745313.24it/s]
 61%|██████    | 1081344/1780178 [00:00&lt;00:00, 2362490.45it/s]
100%|██████████| 1780178/1780178 [00:00&lt;00:00, 3089246.86it/s]
Extracting data/frost.zip to data
</pre></div>
</div>
<section id="reference">
<h3>Reference<a class="headerlink" href="#reference" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>Benchmarking Neural Network Robustness to Common Corruptions and Perturbations</strong>, Dan Hendrycks and Thomas Dietterich. <a class="reference external" href="https://arxiv.org/pdf/1903.12261">ICLR 2019</a>.</p></li>
</ul>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 36.658 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-tutorials-tutorial-corruption-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/fb6a5e9834a7c6a46122640646eaa723/tutorial_corruption.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">tutorial_corruption.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/271afc6f38341c6455eb53e36052da36/tutorial_corruption.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">tutorial_corruption.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../_downloads/936b2a6ee13a252bb11e21317f9ea80d/tutorial_corruption.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">tutorial_corruption.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
</section>


              </article>
              
            </div>
            <footer>
  
  <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
    
    <a href="tutorial_bayesian.html" class="btn btn-neutral float-right" title="Train a Bayesian Neural Network in Three Minutes" accesskey="n"
      rel="next">Next <img src="../_static/images/chevron-right-teal.svg"
        class="next-page"></a>
    
    
    <a href="tutorial_der_cubic.html" class="btn btn-neutral" title="Deep Evidential Regression on a Toy Example" accesskey="p"
      rel="prev"><img src="../_static/images/chevron-right-teal.svg" class="previous-page"> Previous</a>
    
  </div>
  

  <hr>

  <div role="contentinfo">
    <p>
      &copy; Copyright 2024, Adrien Lafage and Olivier Laurent.

    </p>
  </div>
  
  <div>
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a
      href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the
      Docs</a>.
  </div>
   

</footer>
          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Corrupting Images with TorchUncertainty to Benchmark Robustness</a><ul>
<li><a class="reference internal" href="#noise-corruptions">1. Noise Corruptions</a></li>
<li><a class="reference internal" href="#blur-corruptions">2. Blur Corruptions</a></li>
<li><a class="reference internal" href="#other-corruptions">3. Other Corruptions</a><ul>
<li><a class="reference internal" href="#reference">Reference</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
    </section>
  </div>

  


  

  
  <script type="text/javascript" id="documentation_options" data-url_root="../"
    src="../_static/documentation_options.js"></script>
  <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
  <script src="../_static/jquery.js"></script>
  <script src="../_static/underscore.js"></script>
  <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
  <script src="../_static/doctools.js"></script>
  <script src="../_static/sphinx_highlight.js"></script>
  <script src="../_static/clipboard.min.js"></script>
  <script src="../_static/copybutton.js"></script>
  

  

  <script type="text/javascript" src="../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
  </div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://torch-uncertainty.github.io/" aria-label="OpenMMLab"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://github.com/ENSTA-U2IS-AI/torch-uncertainty" target="_blank">GitHub</a>
          </li>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function () {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function (e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>

</html>